<!doctype html>
<head>
  <meta charset="utf-8">

  <title>Enigma</title>
  <meta name="description" content="Enigma">
  <meta name="viewport" content="width=device-width">
   
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>
  
 
<!-- This is the Bootstrap Docs -->

  <script src="http://code.jquery.com/jquery-latest.min.js"></script>

  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
 
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

  <link rel="stylesheet" href="css/index.css">

</head>

<body onload = "getBrainTeaser()">
  
  <nav class="navbar navbar-inverse navbar-static-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand active" href="#">Enigma</a>
    </div>
    <div>
      <ul class="nav navbar-nav navbar-right" style="margin-right: 3%;">
        <li><a href="index.htmnl">Home</a></li>
        <li><a href="#">Create</a></li>
        
        <!-- Drop Down Menu -->

        <li class = "dropdown">
          <a href="#" id = "myAnchor" class="dropdown-toggle" data-toggle="dropdown"> Profile <span class="caret" style="color: white;"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">Profile</a></li>
            <li><a href="#">Solved</a></li>
            <li><a href="#">Unsolved</a></li>
            <li><a href="#">Settings</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="javascript:checkAnswer();">Log Out</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>


  <div id = "main">
  <div id="question">
  <p id = "teaser"> </p>
  <hr class = "line">
  <p id = "answer"> </p>
  </div>
  <!--<textarea id="answer">Your answer goes here!</textarea> -->

  <p class="score"> 10 </p>
  
  <div id= "trioB">
  <button class = "buttons" id="submit" onclick = "checkAnswer()"> Submit </button>
  <button class = "buttons" id="btnanswer" onclick = "showAnswer()"> Give up? </button>
  <button class = "buttons" id="next" onclick = "nextTeaser()"> Skip </button>

</div>
</div>

  <script type="text/javascript">
    Parse.initialize("CnC61CI3beai2RyvnxBrz6omXBuPocQF79eua2Vz", "XH3STCvM2oQFPS1FLqguD7xRMS8Dk5tVKoZ3CwnC");
    var answer = ""
    var name;
    var num = 1;
    var num2 = 0;
    var piece;
    var currentUser = Parse.User.current();
    //document.getElementById("name").innerHTML = "Welcome " + user.get('username');
    currentUser.fetch().then(function (user) {
      //alert(user.get('btval'))
      num = user.get('btval');
      name = user.get('firstName')
      name = capitalize(name)
      
      //alert(num)
      replace();
});
    function replace() {
      num2 = num;
      getBrainTeaser()
      //alert(num2)
    }

    function capitalize(s)
{
    return s[0].toUpperCase() + s.slice(1);
}

    
    
    document.getElementById("myAnchor").text = name
    
    function nextTeaser() {
      num2 = num2 + 1
      //alert(num)
      currentUser.set("btval", num2)
      //alert("Did this work?")
          currentUser.save(null, {
            success: function(user) {
              //alert("Yes it did.")
              document.getElementById("teaser").innerHTML = ""
              document.getElementById("answer").innerHTML = ""
              window.getBrainTeaser();
            },
            error: function(user,error) {
              alert("Error")
            }
          });
      
    }
    function getBrainTeaser() {
     
      var BrainTeaser = Parse.Object.extend("BrainTeasers")
      var query = new Parse.Query(BrainTeaser)
      query.equalTo("Number", num2);
      query.find({
        success: function(results) {
          var object = results[0]
          var teaser = object.get('Question')
          answer = object.get('Answer')
          document.getElementById("teaser").innerHTML = teaser
        },
        error: function(error) {
          alert("Error: " + error.code + " " + error.message);
        }
      });
    }
    function showAnswer() {
      document.getElementById("answer").innerHTML = "<br><b>ANSWER: </b>" + answer
    }

    function checkAnswer() {
    var answer = document.getElementById('answer').value;
    if(answer.indexOf(keyword)) {
      document.getElementById("score").innerHTML = (parseInt(document.getElementById("score").innerHTML) + 1).toString();
    }
  }

  
  </script>
</body>

</html>